<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:insert="~{fragments/PageFrame :: head('Post')}"></div>
<body>
<!-- Responsive navbar-->
<div th:replace="~{fragments/PageFrame :: navbar}"></div>
<!-- Page content-->
<div class="container mt-5">
    <div class="row">
        <div class="col-lg-8">
            <!-- Post content-->
            <article>
                <!-- Post header-->
                <header class="mb-4">
                    <!-- Post title-->
                    <h1 class="fw-bolder mb-1" th:text="${post.title}">Welcome to Blog Post!</h1>
                    <!-- Post meta content-->
                    <div class="text-muted fst-italic mb-2" th:text="${post.creationDate}">Posted on January 1, 2023 by
                        Start Bootstrap
                    </div>
                    <div class="text-muted fst-italic mb-2" th:text="${'Author: ' + post.creator.username}">Creator
                    </div>
                    <!-- Post categories-->
                    <a class="badge bg-secondary text-decoration-none link-light" href="#!" th:each="tags : ${tags}"
                       th:text="${tags.getContent()}">Deff</a>
                </header>
                <!-- Post content-->
                <section class="mb-5">
                    <p class="fs-5 mb-4" th:text="${post.content}">Science is an enterprise that should be cherished as
                        an activity of the free human mind. Because it transforms who we are, how we live, and it gives
                        us an understanding of our place in the universe.</p>
                </section>

                <form th:action="@{/posts/like}" method="post"
                      style="display: flex; align-items: center; justify-content: space-between;">

                    <button type="submit"
                            style="border: none; background: none; padding: 0; font: inherit; cursor: pointer;">
                        <a href="#" style="text-decoration: none;">
                            <i class="fas fa-thumbs-up fa-xs"></i>
                            <span class="small">üëç Like</span>
                        </a>
                    </button>

                    <!--                    <div class="ui labeled button mt-5 ml-5" tabindex="0">-->
                    <!--                        <div class="ui blue button">-->
                    <!--                            <i class="fas fa-thumbs-up"></i>-->
                    <!--                        </div>-->
                    <!--                        <span class="ui basic blue label">0</span>-->
                    <!--                    </div>-->

                    <span th:text="${post.getLikedByUser().size()}"></span> Likes

                    <div th:if="${session.isAdmin} or ${post.creator.getUsername() == session.currentUser}"
                         style="display: flex; justify-content: flex-end;" href="#!">
                        <a href="#" th:href="@{__${requestURI}__/update}" class="btn btn-primary">Edit</a>
                        <h3>|</h3>
                        <a href="#" th:href="@{__${requestURI}__/delete}" class="btn btn-primary">Delete</a>
                    </div>


                </form>

            </article>
            <!-- Comments section-->
            <section class="mb-5">
                <div class="card bg-light">
                    <div class="card-body">
                        <form action="#" th:action="@{/posts/submitComment}" th:object="${commentDto}" th:method="post"
                              class="mb-4">
                            <br/>
                            <textarea class="form-control" rows="3" th:field="*{content}"
                                      placeholder="Write your comment..."></textarea>
                            <br/>
                            <input class="btn btn-primary" type="submit" value="Submit"/>
                        </form>
                        <div class="row d-flex justify-content-center">
                            <div class="mb-4" th:each="singleComment : ${comments}">
                                <div class="card">
                                    <div class="card-body p-4">
                                        <div class="row">
                                            <div class="col">
                                                <div class="d-flex flex-start">
                                                    <img class="rounded-circle shadow-1-strong me-3"
                                                         th:src="${singleComment.creator.photoUrl != null ? (singleComment.creator.photoUrl.startsWith('/') ? singleComment.creator.photoUrl : '/' + singleComment.creator.photoUrl) : '@{/assets/users/defaultUser.png}'}"
                                                         alt="avatar" width="65"
                                                         height="65"/>
                                                    <div class="flex-grow-1 flex-shrink-1">
                                                        <div>
                                                            <div class="d-flex justify-content-between align-items-center">
                                                                <b><p class="mb-1"
                                                                      th:text="${singleComment.creator.username}">
                                                                    Maria Smantha <span
                                                                        class="small">- 2 hours ago</span>
                                                                </p></b>


                                                                <form th:action="@{/posts/like/__${singleComment.id}__}"
                                                                      method="post">

                                                                    <button type="submit"
                                                                            style="border: none; background: none; padding: 0; font: inherit; cursor: pointer;">
                                                                        <a href="#" style="text-decoration: none;">
                                                                            <i class="fas fa-thumbs-up fa-xs"></i><span
                                                                                class="small">üëç Like</span>
                                                                        </a>
                                                                    </button>
                                                                    <span th:text="${singleComment.getLikedList().size()}"></span>
                                                                    Likes
                                                                </form>

                                                            </div>

                                                            <div th:if="${session.isAdmin} or ${singleComment.creator.getUsername() == session.currentUser}"
                                                                 style="display: flex; justify-content: flex-end;"
                                                                 href="#!">
                                                                <a href="#"
                                                                   th:href="@{__${requestURI}__/delete/__${singleComment.id}__}"
                                                                   class="btn btn-primary">Delete</a>
                                                            </div>

                                                            <p class="small mb-0" th:text="${singleComment.content}">
                                                                It is a long established fact that a reader will
                                                                be distracted by
                                                                the readable content of a page.
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
<!-- Footer-->
<div th:replace="~{/fragments/PageFrame :: footer}"></div>
<div th:replace="~{/fragments/PageFrame :: scripts}"></div>
<!--<script src="../static/js/LikeButton.js" th:src="@{/js/LikeButton.js}"></script>-->
</body>
</html>
